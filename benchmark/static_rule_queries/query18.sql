SELECT i_item_id, ca_country, ca_state, ca_county, avg(CAST(cs_quantity AS DECIMAL(12, 2))), avg(CAST(cs_list_price AS DECIMAL(12, 2))), avg(CAST(cs_coupon_amt AS DECIMAL(12, 2))), avg(CAST(cs_sales_price AS DECIMAL(12, 2))), avg(CAST(cs_net_profit AS DECIMAL(12, 2))), avg(CAST(c_birth_year AS DECIMAL(12, 2))), avg(CAST(cd1.cd_dep_count AS DECIMAL(12, 2))) FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk JOIN item ON cs_item_sk = i_item_sk JOIN customer_demographics AS cd1 ON cs_bill_cdemo_sk = cd1.cd_demo_sk JOIN customer ON cs_bill_customer_sk = c_customer_sk JOIN customer_demographics AS cd2 ON c_current_cdemo_sk = cd2.cd_demo_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk WHERE cd1.cd_gender = 'M' AND cd1.cd_education_status = 'Primary' AND c_birth_month IN (1, 2, 9, 5, 11, 3) AND d_year = 1998 AND ca_state IN ('MS', 'NE', 'IA', 'MI', 'GA', 'NY', 'CO') GROUP BY i_item_id, ca_country, ca_state, ca_county WITH ROLLUP ORDER BY ca_country, ca_state, ca_county, i_item_id LIMIT 100
